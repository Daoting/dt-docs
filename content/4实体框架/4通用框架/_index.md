---
weight: 4
title: "通用框架"

tags: []
---

开发时经常将数据处理区分为：`单表、一对多、多对多`三种模式，同一模式在处理过程基本相同，为提高开发效率，平台通过VS扩展，对平时使用频率较高的模式提供代码框架，这样避免了很多重复的工作，当然框架不是万能的，可以通过继续修改以支持特定需求。

以下演示如何利用VS扩展对三种模式生成代码框架，演示前先参见[初始化数据库](/dt-docs/1开始/4搬运工样例/#初始化数据库)准备环境。

{{< admonition >}}
请始终保持Svc运行状态，VS扩展工具会使用该服务
{{< /admonition >}}

## 单实体框架
1. 该实例演示单表增删改查的功能

1. 参见[生成实体代码](/dt-docs/4实体框架/2实体基础/#生成实体代码)，生成表`crud_基础`的实体类`基础X`。此步骤也可省略，Demo.Base项目中已生成
![](1.png)

1. 添加代码框架，右键选择`搬运工 -> 单实体框架`，点击`选择`，选择表`crud_基础`，点击`确认`，生成框架文件
![](2.png)
![](3.png)
![](4.png)
![](5.png)

1. 将Win项目设置为启动项目，F5启动调试，登录成功后在`主页`左侧菜单中点击`菜单管理`，然后增加菜单`单实体`，视图名称`基础Win`，确保和功能主窗口中View标签名相同，成功保存后右下提示需要`更新模型`，点击`更新模型`，如下图所示：
![](9.png "增加菜单项")

1. 将菜单授权`任何人`，关闭并重新启动应用，登录成功后在`主页`左侧菜单中点击`单实体`，将显示单表的增删改查窗口
![](10.png "单表增删改查")

1. 将其他Droid iOS 或 Wasm项目设置为启动项目，同样可运行`单实体`功能
![](11.png)
![](12.png)

## 一对多框架
1. 该实例演示一对多父子表增删改查的功能

1. 在Client项目中添加目录`一对多\Domain`，右键选择`搬运工 -> 实体类`，点击`增加`，选择表`demo_父表 demo_大儿 demo_小儿`，点击`确定`，生成三个实体类
![](13.png)

1. 添加代码框架，右键选择`搬运工 -> 一对多框架`，`父实体`点击`选择`表`demo_父表`，`子实体`选择`demo_大儿 demo_小儿`，将`demo_小儿`的父主键名称修改为`GroupID`，点击`确认`，生成框架文件
![](14.png)
![](15.png)

1. 和[单实体框架](#单实体框架)相同，生成启动项目、添加菜单项(视图名称和主窗口标签名称相同)、菜单授权后，就可打开`一对多`窗口查看默认功能
![](17.png "添加菜单项并授权")
![](16.png "一对多框架")

1. 运行其他平台的App项目，打开`一对多`查看默认功能


## 多对多框架
1. 该实例演示多对多关系表的增删改查功能，用户和角色、权限和角色、角色和用户及权限都是多对多关系，分别以用户、角色、权限为主体实现管理功能。
![](rbac.png)

1. 在Client项目中添加目录`多对多\Domain`，右键选择`搬运工 -> 实体类`，点击`增加`，选择表`demo_角色 demo_用户 demo_权限 demo_角色权限 demo_用户角色`，点击`确定`，生成五个实体类
![](18.png)
![](19.png)

1. 添加以`角色`为主体的代码框架，添加目录`多对多\角色`，右键选择`搬运工 -> 多对多框架`，`主实体`点击`选择`表`demo_角色`，`关联实体`选择`demo_用户 demo_权限`，`中间实体`选择`demo_角色权限 demo_用户角色`，完善`中间实体`的外键字段名，确保`关联实体`和`中间实体`的表顺序对应，点击`确认`，生成框架文件
![](20.png)
![](21.png)

1. 添加以`权限`为主体的代码框架，添加目录`多对多\权限`，右键选择`搬运工 -> 多对多框架`，`主实体`点击`选择`表`demo_权限`，`关联实体`选择`demo_角色`，`中间实体`选择`demo_角色权限`，完善`中间实体`的外键字段名，点击`确认`
![](22.png)
![](23.png)

1. 添加以`用户`为主体的代码框架，添加目录`多对多\用户`，右键选择`搬运工 -> 多对多框架`，`主实体`点击`选择`表`demo_用户`，`关联实体`选择`demo_角色`，`中间实体`选择`demo_用户角色`，完善`中间实体`的外键字段名，点击`确认`
![](24.png)
![](25.png)

1. 和[单实体框架](#单实体框架)相同，生成启动项目、添加三个菜单项(`用户管理 角色管理 权限管理`)、菜单授权后，点击`更新模型`，重启应用即可测试这三个菜单项
![](26.png "添加菜单项并授权")
![](27.png "多对多框架")

{{< admonition info >}}
以上三个例子都是通过VS扩展工具中提供的基础框架自动生成的，这只适用于普通场景，个性化需求还得靠自定义实现，VS扩展中的框架通常用来生成单表、一对多、多对多等不同模式的基础结构，然后在此基础上进行修改以满足需求。
{{< /admonition >}}